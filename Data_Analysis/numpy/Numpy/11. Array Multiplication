{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "bb233d2b-94a4-4182-afaa-ae1a6d6b1617",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 数组乘法\n",
    "# 分别包括数字与一维二维数组相乘，一维数组与一维数组相乘，二维数组与一维数组相乘，二维数组与二维数组相乘\n",
    "# 函数\n",
    "# *或者np.multiply 逐元素乘法，对应位置元素相乘，要求形状相同，元素阵一样或者通过广播一致\n",
    "# @或者np.matmul 矩阵乘法，形状要求满足（n,k）,(k,m)>(n,m)\n",
    "# np.dot 点积乘法\n",
    "# 点积，内积也称数量积，两个向量a=[a1,a2,a3,a4..an],b=[b1.b2.b3.b4.b5...bn]的点积为a·b=a1b1+a2b2+...+anbn"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "906a26a0-4d9a-457d-a459-325e474fde2f",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "ffe8bf3b-6a74-434d-9c43-dda55ea10f15",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# 数字与一维数组二维数组相乘\n",
    "A=np.arange(10)\n",
    "A"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "9e6d9995-6b66-4b2b-a2bd-879f6ee145e9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0. , 0.5, 1. , 1.5, 2. , 2.5, 3. , 3.5, 4. , 4.5])"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "A*0.5"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "6f4aa5d6-b8f1-4ad9-98f2-cdcde60f444c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[ 0,  1,  2,  3],\n",
       "       [ 4,  5,  6,  7],\n",
       "       [ 8,  9, 10, 11]])"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "B=np.arange(12).reshape(3,4)\n",
    "B"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "6325cabc-e482-4795-b0a7-878ea7e562a2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[0. , 0.3, 0.6, 0.9],\n",
       "       [1.2, 1.5, 1.8, 2.1],\n",
       "       [2.4, 2.7, 3. , 3.3]])"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "B*0.3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "8cfb26da-4960-4d3b-b059-3d82c5e14f43",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 一维数组与一维数组相乘"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "bd114165-ad61-45af-8ed3-a9c47a17cc9f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([1, 2, 3, 4, 5, 6, 7, 8, 9])"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "C=np.arange(1,10)\n",
    "C"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "d501f14b-5364-4fd1-a8aa-7d4d931bc967",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0.2, 0.4, 0.6, 0.8, 1. , 1.2, 1.4, 1.6, 1.8])"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "D=np.arange(1,10)*0.2\n",
    "D"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "e4209b93-a457-4f69-a78c-132058f83a56",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([ 0.2,  0.8,  1.8,  3.2,  5. ,  7.2,  9.8, 12.8, 16.2])"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np.multiply(C,D) # 矩阵维度一致"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "41fa72e0-73ae-4a62-8e4e-6cf289182189",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 点积，内积，数量积"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "621e2b93-fb31-4865-87c5-7b85b2dad808",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "57.0"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "C@D"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "78aa49be-b479-4969-a0e9-5b538a268841",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "57.0"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np.matmul(C,D)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "f3ddf093-8c7a-4865-9f39-9a68054ab71c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "57.0"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np.dot(C,D)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f7b4ee39-c765-47d9-9733-796e7b19abea",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 二维数组和一维数组相乘"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "52aab702-a8b9-4b25-90d9-36e3d763ea00",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[ 1,  2,  3,  4],\n",
       "       [ 5,  6,  7,  8],\n",
       "       [ 9, 10, 11, 12],\n",
       "       [13, 14, 15, 16],\n",
       "       [17, 18, 19, 20]])"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "A=np.arange(1,21).reshape(5,4) # 从1开始防止乘积为零\n",
    "A   # 列相同"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "1f99b6f6-8e07-43f6-8c78-16573765c82a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0.1, 0.2, 0.3, 0.4])"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "B=np.arange(1,5)*0.1\n",
    "B"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8eced2a3-f264-45db-91c1-cf3fe38aa8a2",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 逐元素乘法"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "050f96f0-6c9a-4459-8f16-73a0b904ad80",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[0.1, 0.4, 0.9, 1.6],\n",
       "       [0.5, 1.2, 2.1, 3.2],\n",
       "       [0.9, 2. , 3.3, 4.8],\n",
       "       [1.3, 2.8, 4.5, 6.4],\n",
       "       [1.7, 3.6, 5.7, 8. ]])"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "A*B # 一维向量把二维向量按照行乘"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "bf4d8f8c-323f-4209-b582-34f01d70d358",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[0.1, 0.4, 0.9, 1.6],\n",
       "       [0.5, 1.2, 2.1, 3.2],\n",
       "       [0.9, 2. , 3.3, 4.8],\n",
       "       [1.3, 2.8, 4.5, 6.4],\n",
       "       [1.7, 3.6, 5.7, 8. ]])"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np.multiply(A,B)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "011b9234-6e15-4c6f-98fa-9f967493145a",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 矩阵乘法"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "b3e49154-03a9-4036-8182-0a053084765f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([ 3.,  7., 11., 15., 19.])"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "A@B # 按行乘完以后把每行加起来,例如进行逻辑回归，每一行是样本，每一列是特征，而B可看作权重，点积完成以后加和即样本加权后结果"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "e346d571-2eb0-4cf7-933a-d52dd8d6baca",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([ 3.,  7., 11., 15., 19.])"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np.matmul(A,B)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "1f06eaa2-80e5-462b-a58b-f94f76732803",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([ 3.,  7., 11., 15., 19.])"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np.dot(A,B)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "43ecc98c-9664-49c9-8a2a-7c4965c42a54",
   "metadata": {},
   "outputs": [],
   "source": [
    "# A,B都是二维数组，实现矩阵乘法，两个矩阵形状需要匹配，即第一个数组的第二维等于第二个数组的第一维"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "6b7d510b-910a-4cf7-9ce5-5a601abc1779",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[ 0,  1,  2,  3],\n",
       "       [ 4,  5,  6,  7],\n",
       "       [ 8,  9, 10, 11]])"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "A=np.arange(12).reshape(3,4)\n",
    "A"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "4dbc67dc-a92e-4b1e-83d9-03bc80e1754e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[ 0,  1,  2,  3,  4],\n",
       "       [ 5,  6,  7,  8,  9],\n",
       "       [10, 11, 12, 13, 14],\n",
       "       [15, 16, 17, 18, 19]])"
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "B=np.arange(20).reshape(4,5)\n",
    "B"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "63854117-fc8a-4f4b-8eb6-33a4e5d01472",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[ 70,  76,  82,  88,  94],\n",
       "       [190, 212, 234, 256, 278],\n",
       "       [310, 348, 386, 424, 462]])"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "A@B"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "6faf1075-4420-4c85-8778-b89b411cb3f0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[ 70,  76,  82,  88,  94],\n",
       "       [190, 212, 234, 256, 278],\n",
       "       [310, 348, 386, 424, 462]])"
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np.matmul(A,B)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "c83f1983-3e94-4433-a644-d7c48f7c7c10",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[ 70,  76,  82,  88,  94],\n",
       "       [190, 212, 234, 256, 278],\n",
       "       [310, 348, 386, 424, 462]])"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np.dot(A,B)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "0605b6ae-b23c-4b02-a34d-7fe67bac4266",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 输出的结果将是共同的维度消融，进而保留第一个数组的第一维和第二个数组的第二维\n",
    "# 数字结果是线性代数，点积后的矩阵的第一个数字是第一个矩阵的第一行分别乘第二个矩阵的第一列得到的乘积和，也就是说只有相同维度的那一边可以进行计算\n",
    "# 见补充笔记"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "61da529a-0e30-4302-8875-a0271634abd2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[1, 2, 3],\n",
       "       [4, 5, 6]])"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "A=np.arange(1,7).reshape(2,3)\n",
    "A"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "ee215ec0-4145-4e60-b25b-712f1238ecd3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[ 1,  2,  3,  4],\n",
       "       [ 5,  6,  7,  8],\n",
       "       [ 9, 10, 11, 12]])"
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "B=np.arange(1,13).reshape(3,4)\n",
    "B"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "5fe0bd96-c8f8-4df2-b2b2-75d8bd9dc611",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[ 38,  44,  50,  56],\n",
       "       [ 83,  98, 113, 128]])"
      ]
     },
     "execution_count": 44,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np.matmul(A,B)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dae56bec-6628-44c1-bb7c-860c2b668c10",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.1"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
